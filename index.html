<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shikoku Links</title>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #2A2D43 0%, #1C1E2D 100%);
            --card-bg: rgba(255, 255, 255, 0.1);
            --text-primary: #E8EDF3;
            --text-secondary: #B4C0D0;
            --accent-color: #64FFDA;
            --border-color: rgba(255, 255, 255, 0.1);
            --card-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.2);
            --glass-effect: backdrop-filter: blur(10px);
        }

        body {
            font-family: 'Inter', Arial, sans-serif;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
            background: var(--primary-gradient);
            color: var(--text-primary);
            min-height: 100vh;
        }
        
        .content-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background: var(--card-bg);
            border-radius: 16px;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }
        
        .content-table th {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            text-align: left;
            padding: 8px;
            border: 1px solid var(--border-color);
        }
        
        .content-table td {
            padding: 8px;
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
        }
        
        .content-table tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.02);
        }
        
        .date-section {
            margin-bottom: 20px;
        }
        
        .date-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .weather-link {
            margin-bottom: 5px;
        }
        
        h1, h2 {
            color: var(--text-primary);
            font-weight: 600;
        }
        
        /* New Weather Links Styling */
        .weather-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            gap: 15px;
        }
        
        .weather-card {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: var(--card-shadow);
            padding: 15px;
            width: calc(33.333% - 15px);
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            border-left: 4px solid var(--accent-color);
        }
        
        .weather-date {
            font-weight: bold;
            font-size: 18px;
            color: var(--text-primary);
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .weather-location {
            margin: 8px 0;
        }
        
        .weather-location a {
            display: block;
            color: var(--text-secondary);
            text-decoration: none;
            padding: 6px 10px;
            border-radius: 4px;
            transition: color 0.3s ease;
        }
        
        .weather-location a:hover {
            color: var(--accent-color);
            background: rgba(255, 255, 255, 0.05);
        }
        
        .weather-icon {
            margin-right: 8px;
            color: #5c9ce6;
        }
        
        @media (max-width: 768px) {
            .weather-card {
                width: calc(50% - 15px);
            }
        }
        
        @media (max-width: 480px) {
            .weather-card {
                width: 100%;
            }
        }
        
        /* Add styles for tabs */
        .tab-container {
            margin: 20px 0;
        }
        
        .tab-buttons {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            overflow-x: auto;  /* Allow horizontal scroll on small screens */
            -webkit-overflow-scrolling: touch;  /* Smooth scroll on iOS */
            scrollbar-width: none;  /* Hide scrollbar on Firefox */
            -ms-overflow-style: none;  /* Hide scrollbar on IE/Edge */
        }
        
        /* Hide scrollbar on Webkit browsers */
        .tab-buttons::-webkit-scrollbar {
            display: none;
        }
        
        .tab-button {
            padding: 8px 16px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            color: var(--text-secondary);
            transition: all 0.3s ease;
            white-space: nowrap;
            flex: none;  /* Don't allow buttons to grow/shrink */
            -webkit-appearance: none;  /* Remove default iOS styling */
            appearance: none;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }
        
        .tab-button:hover {
            background: rgba(255, 255, 255, 0.15);
            color: var(--accent-color);
        }
        
        .tab-button.active {
            background: rgba(100, 255, 218, 0.1);
            color: var(--accent-color);
            border-color: var(--accent-color);
            border-radius: 8px !important;  /* Force border radius on iOS */
            -webkit-border-radius: 8px !important;
        }
        
        /* Ensure consistent button appearance on iOS */
        @supports (-webkit-touch-callout: none) {
            .tab-button {
                -webkit-border-radius: 8px;
                border-radius: 8px;
            }
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Remove sticky positioning from quick links since we're using tabs */
        .quick-links {
            display: none; /* Hide the quick links since we have tabs now */
        }
        
        /* Remove collapsible styles */
        .section-header {
            cursor: default;
        }
        
        .toggle-btn {
            display: none;
        }
        
        /* Restore and improve info card styles */
        .info-card {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: var(--card-shadow);
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            border-left: 4px solid var(--accent-color);
        }
        
        .info-card .info-title {
            display: flex;
            align-items: center;
            justify-content: space-between;
            cursor: pointer;
            user-select: none;
            color: var(--text-primary);
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .info-card .info-content {
            max-height: 1000px;
            transition: max-height 0.3s ease-out;
            overflow: hidden;
        }
        
        .info-card .info-content.collapsed {
            max-height: 0;
            margin: 0;
            padding: 0;
        }
        
        .info-label {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 3px;
        }
        
        .info-value {
            color: var(--text-primary);
            font-size: 15px;
            margin-bottom: 10px;
        }
        
        /* Add timeline indicator */
        .timeline-indicator {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-left: 10px;
            background: rgba(100, 255, 218, 0.1);
            color: var(--accent-color);
            border: 1px solid var(--accent-color);
        }
        
        /* Restore toggle button for info cards */
        .info-card .toggle-btn {
            display: inline-block;
            background: none;
            border: none;
            color: #4a90e2;
            cursor: pointer;
            font-size: 16px;
            padding: 0 10px;
            transition: transform 0.3s;
        }
        
        .info-card .toggle-btn.collapsed {
            transform: rotate(-90deg);
        }
        
        /* Add hover effect for info cards */
        .info-card:hover {
            transform: translateY(-2px);
            transition: transform 0.3s ease;
        }

        /* Update weather card styles */
        .weather-card {
            background: var(--card-bg);
            border-radius: 16px;
            box-shadow: var(--card-shadow);
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
            border-left: 4px solid var(--accent-color);
        }

        .weather-date {
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-color);
        }

        .weather-location a {
            color: var(--text-secondary);
            transition: color 0.3s ease;
        }

        .weather-location a:hover {
            color: var(--accent-color);
            background: rgba(255, 255, 255, 0.05);
        }

        /* Update table styles */
        .content-table {
            background: var(--card-bg);
            border-radius: 16px;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .content-table th {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .content-table td {
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
        }

        .content-table tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.02);
        }

        .content-table a {
            color: var(--accent-color);
            text-decoration: none;
        }

        .content-table a:hover {
            text-decoration: underline;
        }

        /* Add subtle hover effects */
        .info-card:hover, .weather-card:hover {
            transform: translateY(-2px);
            transition: transform 0.3s ease;
        }

        /* Add scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent-color);
            border-radius: 4px;
        }

        /* Document timeline styles */
        .document-timeline {
            position: relative;
            padding: 20px 0;
        }

        .document-timeline::before {
            content: '';
            position: absolute;
            left: 85px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--accent-color);
            opacity: 0.3;
        }

        .document-card {
            position: relative;
            margin-left: 110px;
            margin-bottom: 20px;
            padding: 15px 20px;
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        .document-card::before {
            content: '';
            position: absolute;
            left: -25px;
            top: 50%;
            width: 25px;
            height: 2px;
            background: var(--accent-color);
            opacity: 0.3;
        }

        .document-card::after {
            content: '';
            position: absolute;
            left: -35px;
            top: calc(50% - 6px);
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--accent-color);
            border: 2px solid var(--primary-gradient);
            z-index: 1;
        }

        .document-date {
            position: absolute;
            left: -95px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--accent-color);
            font-size: 12px;
            font-weight: bold;
            background: var(--primary-gradient);
            padding: 4px 8px;
            border-radius: 4px;
            width: 35px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .document-location {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 5px;
        }

        .document-link {
            display: flex;
            align-items: center;
            color: var(--text-primary);
            text-decoration: none;
            font-size: 16px;
        }

        .document-link:hover {
            color: var(--accent-color);
        }

        .document-icon {
            margin-right: 10px;
            font-size: 20px;
        }

        @media (max-width: 768px) {
            .document-timeline::before {
                left: 70px;
            }
            .document-card {
                margin-left: 95px;
            }
            .document-date {
                left: -80px;
                font-size: 11px;
                padding: 3px 6px;
                width: 35px;
            }
            .document-card::before {
                left: -25px;
                width: 25px;
            }
            .document-card::after {
                left: -35px;
            }
        }

        /* Weather timeline styles - similar to document timeline */
        .weather-timeline {
            position: relative;
            padding: 20px 0;
        }

        .weather-timeline::before {
            content: '';
            position: absolute;
            left: 85px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: var(--accent-color);
            opacity: 0.3;
        }

        .weather-day-card {
            position: relative;
            margin-left: 110px;
            margin-bottom: 20px;
            padding: 15px 20px;
            background: var(--card-bg);
            border-radius: 12px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        .weather-day-card::before {
            content: '';
            position: absolute;
            left: -25px;
            top: 50%;
            width: 25px;
            height: 2px;
            background: var(--accent-color);
            opacity: 0.3;
        }

        .weather-day-card::after {
            content: '';
            position: absolute;
            left: -35px;
            top: calc(50% - 6px);
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--accent-color);
            border: 2px solid var(--primary-gradient);
        }

        .weather-day-date {
            position: absolute;
            left: -95px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--accent-color);
            font-size: 12px;
            font-weight: bold;
            background: var(--primary-gradient);
            padding: 4px 8px;
            border-radius: 4px;
            width: 35px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .weather-locations {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .weather-location-link {
            display: flex;
            align-items: center;
            color: var(--text-primary);
            text-decoration: none;
            font-size: 16px;
            padding: 8px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .weather-location-link:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--accent-color);
            transform: translateX(5px);
        }

        .weather-day-info {
            color: var(--text-secondary);
            font-size: 12px;
            margin-top: 5px;
            padding-top: 5px;
            border-top: 1px solid var(--border-color);
        }

        @media (max-width: 768px) {
            .weather-timeline::before {
                left: 70px;
            }
            .weather-day-card {
                margin-left: 95px;
            }
            .weather-day-date {
                left: -80px;
                font-size: 11px;
                padding: 3px 6px;
                width: 35px;
            }
            .weather-day-card::before {
                left: -25px;
                width: 25px;
            }
            .weather-day-card::after {
                left: -35px;
            }
        }

        /* Location details styling */
        .location-details {
            margin-top: 10px;
        }

        .location-name {
            font-size: 16px;
            color: var(--text-primary);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .location-info {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .info-tag {
            color: var(--accent-color);
            margin-right: 8px;
        }

        .location-links {
            display: flex;
            gap: 12px;
            margin-top: 8px;
        }

        .map-link {
            display: inline-flex;
            align-items: center;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 14px;
            padding: 4px 8px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }

        .map-link:hover {
            color: var(--accent-color);
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(2px);
        }

        .document-icon {
            margin-right: 6px;
        }

        /* Additional adjustments for very small screens */
        @media (max-width: 360px) {
            .tab-buttons {
                gap: 6px;
                padding-bottom: 8px;
            }
            
            .tab-button {
                padding: 6px 12px;
                font-size: 13px;
            }
            
            body {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <h1>Shikoku In a Nutshell</h1>
    
    <!-- Tab Navigation -->
    <div class="tab-container">
        <div class="tab-buttons">
            <button class="tab-button active" onclick="showTab('flight-lodging')">Flight & Lodging</button>
            <button class="tab-button" onclick="showTab('navigation')">Navigation</button>
            <button class="tab-button" onclick="showTab('documents')">Documents</button>
            <button class="tab-button" onclick="showTab('weather')">Weather</button>
        </div>
        
        <!-- Flight & Lodging Tab -->
        <div id="flight-lodging" class="tab-content active">
            <div class="info-card">
                <div class="info-title" onclick="toggleInfoCard(this)">
                    ✈️ Flight Information (HK Express)
                    <span class="timeline-indicator">14/3 - 19/3</span>
                    <button class="toggle-btn">▼</button>
                </div>
                <div class="info-content">
                    <div class="info-label">🛫 Outbound Flight</div>
                    <div class="info-value">
                        🇭🇰 HKG → TAK 🇯🇵 (UO642)<br>
                        📅 14 March 2025, Friday<br>
                        🕒 Departure: 09:25 (Terminal 1)<br>
                        🛬 Arrival: 13:45
                    </div>
                    <div class="info-label">🛫 Return Flight</div>
                    <div class="info-value">
                        🇯🇵 TAK → HKG 🇭🇰<br>
                        📅 19 March 2025, Wednesday<br>
                        🕒 Departure: 14:35<br>
                        🛬 Arrival: 18:00 (Terminal 1)
                    </div>
                </div>
            </div>

            <div class="info-card">
                <div class="info-title" onclick="toggleInfoCard(this)">
                    🏨 Hotel Fav Takamatsu
                    <span class="timeline-indicator">14/3, 16-19/3</span>
                    <button class="toggle-btn">▼</button>
                </div>
                <div class="info-content">
                    <div class="info-label">📍 Address</div>
                    <div class="info-value">2-2-1 Kawara-machi, Takamatsu, Kagawa 760-0052, Japan</div>
                    <div class="info-label">📞 Phone</div>
                    <div class="info-value">+81 87-811-7777</div>
                    <div class="info-label">🕒 Check-in</div>
                    <div class="info-value">From 15:00</div>
                    <div class="info-label">🕒 Check-out</div>
                    <div class="info-value">Until 10:00</div>
                </div>
            </div>

            <div class="info-card">
                <div class="info-title" onclick="toggleInfoCard(this)">
                    ⛺ GLAMPREMIER Setouchi
                    <span class="timeline-indicator">15/3</span>
                    <button class="toggle-btn">▼</button>
                </div>
                <div class="info-content">
                    <div class="info-label">📍 Address</div>
                    <div class="info-value">2098-1 Toyohama, Kanonji, Kagawa 769-0210, Japan</div>
                    <div class="info-label">📞 Phone</div>
                    <div class="info-value">+81 875-56-5338</div>
                    <div class="info-label">🕒 Check-in</div>
                    <div class="info-value">15:00 - 17:00</div>
                </div>
            </div>
        </div>
        
        <!-- Navigation Tab -->
        <div id="navigation" class="tab-content">
            <div class="document-timeline">
                <div class="document-card">
                    <div class="document-date">15/3</div>
                    <div class="document-location">Kotohira</div>
                    <div class="location-details">
                        <div class="location-name">
                            <span class="document-icon">⛩️</span>
                            Kotohira-gu Shrine
                        </div>
                        <div class="location-info">
                            <span class="info-tag">📍 Map Code:</span> 587 328 396
                        </div>
                        <div class="location-links">
                            <a href="https://goo.gl/maps/rQPBNEJvUVNrp4x49" target="_blank" class="map-link">
                                <span class="document-icon">🗺️</span> Google Maps
                            </a>
                            <a href="https://maps.apple.com/?address=892-1%20Kotohira,%20Kotohira-cho,%20Nakatado-gun,%20Kagawa%20766-0001,%20Japan&auid=7991199917932067948&ll=34.185417,133.810222&lsp=9902&q=Kotohira-gu%20Shrine&t=m" target="_blank" class="map-link">
                                <span class="document-icon">🍎</span> Apple Maps
                            </a>
                        </div>
                    </div>
                </div>

                <div class="document-card">
                    <div class="document-date">15/3</div>
                    <div class="document-location">Kanonji</div>
                    <div class="location-details">
                        <div class="location-name">
                            <span class="document-icon">⛺</span>
                            GLAMPREMIER Setouchi
                        </div>
                        <div class="location-info">
                            <span class="info-tag">📍 Map Code:</span> 631 488 859*88
                        </div>
                        <div class="location-links">
                            <a href="https://goo.gl/maps/N5H8YPFPFvVBGp1S7" target="_blank" class="map-link">
                                <span class="document-icon">🗺️</span> Google Maps
                            </a>
                            <a href="#" target="_blank" class="map-link">
                                <span class="document-icon">🚗</span> Navigation
                            </a>
                        </div>
                    </div>
                </div>

                <div class="document-card">
                    <div class="document-date">16/3</div>
                    <div class="document-location">Miyoshi</div>
                    <div class="location-details">
                        <div class="location-name">
                            <span class="document-icon">🌉</span>
                            Iya Kazurabashi Bridge
                        </div>
                        <div class="location-info">
                            <span class="info-tag">📍 Map Code:</span> 627 843 088
                        </div>
                        <div class="location-links">
                            <a href="https://goo.gl/maps/N5H8YPFPFvVBGp1S7" target="_blank" class="map-link">
                                <span class="document-icon">🗺️</span> Google Maps
                            </a>
                            <a href="#" target="_blank" class="map-link">
                                <span class="document-icon">📸</span> Photos
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Documents Tab -->
        <div id="documents" class="tab-content">
            <div class="document-timeline">
                <div class="document-card">
                    <div class="document-date">14/3</div>
                    <div class="document-location">高松</div>
                    <a href="Beef_Man8_Booking.png" class="document-link">
                        <span class="document-icon">🥩</span>
                        高松　黒毛和牛　文八 Booking
                    </a>
                </div>

                <div class="document-card">
                    <div class="document-date">15/3</div>
                    <div class="document-location">金刀比羅宮</div>
                    <a href="kotohiragu_guide-map.pdf" class="document-link">
                        <span class="document-icon">🗺️</span>
                        大Map
                    </a>
                </div>

                <div class="document-card">
                    <div class="document-date">15/3</div>
                    <div class="document-location">金刀比羅宮</div>
                    <a href="kotohiragu_illustrated-map.pdf" class="document-link">
                        <span class="document-icon">🎨</span>
                        細Map
                    </a>
                </div>

                <div class="document-card">
                    <div class="document-date">15/3</div>
                    <div class="document-location">Glamping</div>
                    <a href="GlamPremier_Booking_Confirmation.png" class="document-link">
                        <span class="document-icon">⛺</span>
                        GlamPremier confirmation
                    </a>
                </div>
                
                <div class="document-card">
                    <div class="document-date">15/3</div>
                    <div class="document-location">Glamping</div>
                    <a href="https://kotohiki-kairo.co.jp/sauna/" class="document-link">
                        <span class="document-icon">⛺</span>
                        桑拿 Information
                    </a>
                </div>

                
                <div class="document-card">
                    <div class="document-date">16/3</div>
                    <div class="document-location">Miyoshi</div>
                    <a href="#" class="document-link">
                        <span class="document-icon">🏞️</span>
                        Iya Valley Itinerary
                    </a>
                </div>

                <div class="document-card">
                    <div class="document-date">17/3</div>
                    <div class="document-location">Tokushima</div>
                    <a href="#" class="document-link">
                        <span class="document-icon">🎭</span>
                        Tokushima Activities
                    </a>
                </div>

                <div class="document-card">
                    <div class="document-date">18/3</div>
                    <div class="document-location">Shodo Island</div>
                    <a href="#" class="document-link">
                        <span class="document-icon">🏝️</span>
                        Shodo Island Tour
                    </a>
                </div>

                <div class="document-card">
                    <div class="document-date">19/3</div>
                    <div class="document-location">Takamatsu</div>
                    <a href="#" class="document-link">
                        <span class="document-icon">✈️</span>
                        Return Information
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Weather Tab -->
        <div id="weather" class="tab-content">
            <div id="weather-links-container" class="weather-timeline">
                <!-- Weather links will be dynamically inserted here -->
            </div>
        </div>
    </div>

    <script>
        function showTab(tabId) {
            // Hide all tab contents
            const tabContents = document.getElementsByClassName('tab-content');
            for (let content of tabContents) {
                content.classList.remove('active');
            }
            
            // Deactivate all tab buttons
            const tabButtons = document.getElementsByClassName('tab-button');
            for (let button of tabButtons) {
                button.classList.remove('active');
            }
            
            // Show selected tab content and activate its button
            document.getElementById(tabId).classList.add('active');
            const activeButton = Array.from(tabButtons).find(button => 
                button.textContent.toLowerCase().includes(tabId.replace('-', ' '))
            );
            if (activeButton) {
                activeButton.classList.add('active');
            }
        }

        function toggleInfoCard(titleElement) {
            const content = titleElement.nextElementSibling;
            const button = titleElement.querySelector('.toggle-btn');
            content.classList.toggle('collapsed');
            button.classList.toggle('collapsed');
        }

        function generateWeatherLinks() {
            const weatherContainer = document.getElementById('weather-links-container');
            
            // Get current date in Japan timezone
            const japanTime = new Date(new Date().toLocaleString("en-US", {timeZone: "Asia/Tokyo"}));
            const today = japanTime;
            
            // Updated Weather link data with Chinese names
            const weatherLinks = [
                {
                    date: "14/3",
                    links: [
                        { label: "Takamatsu-shi (高松市)", url: "https://www.accuweather.com/en/jp/takamatsu-shi/224352/daily-weather-forecast/224352?day=" }
                    ]
                },
                {
                    date: "15/3",
                    links: [
                        { label: "Kotohira (琴平町)", url: "https://www.accuweather.com/en/jp/kotohira-cho/218416/daily-weather-forecast/218416?day=" },
                        { label: "Glamping (豊浜町和田)", url: "https://www.accuweather.com/en/jp/toyohamacho-wada/218429/daily-weather-forecast/218429?day=" }
                    ]
                },
                {
                    date: "16/3",
                    links: [
                        { label: "Snow Park (大野原町丸井)", url: "https://www.accuweather.com/en/jp/onoharacho-marui/2387475/daily-weather-forecast/2387475?day=" },
                        { label: "Miyoshi-shi (三好市)", url: "https://www.accuweather.com/en/jp/miyoshi-shi/1-2333814_1_al/daily-weather-forecast/1-2333814_1_al?day=" },
                        { label: "Takamatsu-shi (高松市)", url: "https://www.accuweather.com/en/jp/takamatsu-shi/224352/daily-weather-forecast/224352?day=" }
                    ]
                },
                {
                    date: "17/3",
                    links: [
                        { label: "Tokushima-shi (徳島市)", url: "https://www.accuweather.com/en/jp/tokushima-shi/1-226392_1_al/daily-weather-forecast/1-226392_1_al?day=" }
                    ]
                },
                {
                    date: "18/3",
                    links: [
                        { label: "Shodo Island (小豆島)", url: "https://www.accuweather.com/en/jp/shodo/2413188/daily-weather-forecast/2413188?day=" }
                    ]
                },
                {
                    date: "19/3",
                    links: [
                        { label: "Takamatsu-shi (高松市)", url: "https://www.accuweather.com/en/jp/takamatsu-shi/224352/daily-weather-forecast/224352?day=" }
                    ]
                }
            ];

            // Calculate the day parameter based on date string
            const calculateDayParam = (dateStr) => {
                // Parse the date string (format: "DD/M")
                const [day, month] = dateStr.split('/').map(num => parseInt(num, 10));
                
                // Create Date objects for the target date and today in Japan time
                const currentYear = today.getFullYear();
                
                // Create target date (assuming the dates are for the current year)
                let targetDate = new Date(currentYear, month - 1, day);
                targetDate = new Date(targetDate.toLocaleString("en-US", {timeZone: "Asia/Tokyo"}));
                
                // If the target date is in the past (for this year), assume it's for next year
                if (targetDate < today) {
                    targetDate = new Date(currentYear + 1, month - 1, day);
                    targetDate = new Date(targetDate.toLocaleString("en-US", {timeZone: "Asia/Tokyo"}));
                }
                
                // Calculate days difference - use more reliable method
                const oneDay = 24 * 60 * 60 * 1000; // hours*minutes*seconds*milliseconds
                const todayDate = new Date(today.getFullYear(), today.getMonth(), today.getDate());
                const targetDay = new Date(targetDate.getFullYear(), targetDate.getMonth(), targetDate.getDate());
                
                // Ensure both dates are in Japan timezone
                const todayJST = new Date(todayDate.toLocaleString("en-US", {timeZone: "Asia/Tokyo"}));
                const targetJST = new Date(targetDay.toLocaleString("en-US", {timeZone: "Asia/Tokyo"}));
                
                const diffDays = Math.floor((targetJST - todayJST) / oneDay);
                
                // Add 1 to all calculated offsets to fix the issue
                return diffDays + 1;
            };

            // Create HTML for each date section
            weatherLinks.forEach(dateSection => {
                const card = document.createElement('div');
                card.className = 'weather-day-card';
                
                const dateLabel = document.createElement('div');
                dateLabel.className = 'weather-day-date';
                dateLabel.textContent = dateSection.date;
                
                const locationsDiv = document.createElement('div');
                locationsDiv.className = 'weather-locations';
                
                // Calculate days from today for display
                const [day, month] = dateSection.date.split('/').map(num => parseInt(num, 10));
                const currentYear = today.getFullYear();
                let targetDate = new Date(currentYear, month - 1, day);
                
                if (targetDate < today) {
                    targetDate = new Date(currentYear + 1, month - 1, day);
                }
                
                const oneDay = 24 * 60 * 60 * 1000;
                const todayDate = new Date(today.getFullYear(), today.getMonth(), today.getDate());
                const targetDay = new Date(targetDate.getFullYear(), targetDate.getMonth(), targetDate.getDate());
                
                const daysFromToday = Math.floor((targetDay - todayDate) / oneDay);
                
                // Create links for this date
                dateSection.links.forEach(link => {
                    const a = document.createElement('a');
                    const dayParam = calculateDayParam(dateSection.date);
                    a.href = link.url + dayParam;
                    a.className = 'weather-location-link';
                    a.target = "_blank";
                    
                    const iconSpan = document.createElement('span');
                    iconSpan.className = 'weather-icon';
                    iconSpan.innerHTML = '🌡️';
                    a.appendChild(iconSpan);
                    
                    const textSpan = document.createElement('span');
                    textSpan.textContent = link.label;
                    a.appendChild(textSpan);
                    
                    locationsDiv.appendChild(a);
                });
                
                // Add day info
                const dayInfo = document.createElement('div');
                dayInfo.className = 'weather-day-info';
                if (daysFromToday === 0) {
                    dayInfo.textContent = "Today";
                } else if (daysFromToday === 1) {
                    dayInfo.textContent = "Tomorrow";
                } else {
                    dayInfo.textContent = `${daysFromToday} days from today`;
                }
                
                card.appendChild(dateLabel);
                card.appendChild(locationsDiv);
                card.appendChild(dayInfo);
                weatherContainer.appendChild(card);
            });
        }

        // Modified window.onload
        window.onload = function() {
            generateWeatherLinks();
            if (typeof generateLinks === 'function') {
                generateLinks();
            }
            // No need for collapse logic anymore
        };
    </script>
</body>
</html> 
